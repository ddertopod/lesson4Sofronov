# Шаг 1: Конвертация модели Image Captioning в ONNX

## Описание

Конвертация предобученной модели BLIP для генерации описаний изображений в формат ONNX и тестирование производительности.

## Структура

```
step1_onnx_model/
├── src/
│   ├── model_converter.py  # Конвертер PyTorch -> ONNX
│   └── onnx_tester.py      # Тестер ONNX модели
├── main.py                 # Основной скрипт демонстрации
├── models/                 # Папка для сохранения ONNX модели
└── pyproject.toml         # Зависимости Poetry
```

## Установка

```bash
poetry install
poetry shell
```

## Запуск

### Полная демонстрация

```bash
python main.py
```

### Отдельные компоненты

Только конвертация:
```bash
python -m src.model_converter
```

Только тестирование (требует готовую ONNX модель):
```bash
python -m src.onnx_tester
```

## Что делает скрипт

1. Загружает предобученную модель BLIP от Salesforce
2. Тестирует PyTorch модель на примере изображения
3. Конвертирует модель в формат ONNX с оптимизациями
4. Проверяет корректность ONNX модели
5. Тестирует ONNX инференс
6. Замеряет производительность (latency метрики)

## Результат

- ONNX модель сохраняется в `models/blip_model.onnx`
- Вывод статистики производительности (P50, P95, P99 latency)
- Сравнение работы PyTorch и ONNX версий
